# Auto-generated by Recipe Engine, do not modify manually.
# This job is generated by the wrench recipe engine module, see find the docs here: http://Go/ii2fb

# Parent Preview APV Job.
all_preview_apv_jobs:
  name: All Preview APV Jobs
  dependencies:
  - path: .yamato/wrench/preview-a-p-v.yml#preview_apv_-_6000_3_-_macos
  - path: .yamato/wrench/preview-a-p-v.yml#preview_apv_-_6000_3_-_ubuntu
  - path: .yamato/wrench/preview-a-p-v.yml#preview_apv_-_6000_3_-_windows
  - path: .yamato/wrench/preview-a-p-v.yml#preview_apv_-_6000_4_-_macos
  - path: .yamato/wrench/preview-a-p-v.yml#preview_apv_-_6000_4_-_ubuntu
  - path: .yamato/wrench/preview-a-p-v.yml#preview_apv_-_6000_4_-_windows
  metadata:
    Job Maintainers: '#rm-packageworks'
    Wrench: 1.1.0.0

# Functional tests for dependents found in the latest 6000.3 manifest (MacOS).
preview_apv_-_6000_3_-_macos:
  name: Preview APV - 6000.3 - macos
  agent:
    image: package-ci/macos-13:default
    type: Unity::VM::osx
    flavor: b1.xlarge
  commands:
  - command: curl https://artifactory.prd.it.unity3d.com/artifactory/stevedore-unity-internal/wrench-localapv/1-2-68_53c92d3b34ce3f4b652c9785dd1530bdc5885f6523465d6969c3be91f9ccaaf1.zip -o wrench-localapv.zip
  - command: 7z x -aoa wrench-localapv.zip
  - command: pip install semver requests --index-url https://artifactory-slo.bf.unity3d.com/artifactory/api/pypi/pypi/simple
  - command: python PythonScripts/print_machine_info.py
  - command: npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
    timeout: 20
    retries: 10
  - command: unity-downloader-cli -u 6000.3/staging -c editor --path .Editor --fast
    timeout: 10
    retries: 3
  - command: python PythonScripts/preview_apv.py --wrench-config=.yamato/wrench/wrench_config.json --editor-version=6000.3 --testsuite=editor,playmode --artifacts-path=PreviewApvArtifacts~
  - command: echo 'Skipping Editor Manifest Validator as it is only supported on Windows'
  after:
  - command: bash .yamato/generated-scripts/infrastructure-instability-detection-mac.sh
  artifacts:
    Crash Dumps:
      paths:
      - CrashDumps/**
    logs:
      paths:
      - '*.log'
      - '*.xml'
      - upm-ci~/test-results/**/*
      - upm-ci~/temp/*/Logs/**
      - upm-ci~/temp/*/Library/*.log
      - upm-ci~/temp/*/*.log
      - upm-ci~/temp/Builds/*.log
    packages:
      paths:
      - upm-ci~/packages/**/*
    PreviewAPVResults:
      paths:
      - PreviewApvArtifacts~/**
      - APVTest/**/manifest.json
    pvp-results:
      paths:
      - upm-ci~/pvp/**/*
      browsable: onDemand
  dependencies:
  - path: .yamato/wrench/package-pack-jobs.yml#package_pack_-_webrtc
  variables:
    UPMPVP_CONTEXT_WRENCH: 1.1.0.0
  metadata:
    Job Maintainers: '#rm-packageworks'
    Wrench: 1.1.0.0

# Functional tests for dependents found in the latest 6000.3 manifest (Ubuntu).
preview_apv_-_6000_3_-_ubuntu:
  name: Preview APV - 6000.3 - ubuntu
  agent:
    image: package-ci/ubuntu-22.04:v4
    type: Unity::VM
    flavor: b1.large
  commands:
  - command: curl https://artifactory.prd.it.unity3d.com/artifactory/stevedore-unity-internal/wrench-localapv/1-2-68_53c92d3b34ce3f4b652c9785dd1530bdc5885f6523465d6969c3be91f9ccaaf1.zip -o wrench-localapv.zip
  - command: 7z x -aoa wrench-localapv.zip
  - command: pip install semver requests --index-url https://artifactory-slo.bf.unity3d.com/artifactory/api/pypi/pypi/simple
  - command: python PythonScripts/print_machine_info.py
  - command: npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
    timeout: 20
    retries: 10
  - command: unity-downloader-cli -u 6000.3/staging -c editor --path .Editor --fast
    timeout: 10
    retries: 3
  - command: python PythonScripts/preview_apv.py --wrench-config=.yamato/wrench/wrench_config.json --editor-version=6000.3 --testsuite=editor,playmode --artifacts-path=PreviewApvArtifacts~
  - command: echo 'Skipping Editor Manifest Validator as it is only supported on Windows'
  after:
  - command: bash .yamato/generated-scripts/infrastructure-instability-detection-linux.sh
  artifacts:
    Crash Dumps:
      paths:
      - CrashDumps/**
    logs:
      paths:
      - '*.log'
      - '*.xml'
      - upm-ci~/test-results/**/*
      - upm-ci~/temp/*/Logs/**
      - upm-ci~/temp/*/Library/*.log
      - upm-ci~/temp/*/*.log
      - upm-ci~/temp/Builds/*.log
    packages:
      paths:
      - upm-ci~/packages/**/*
    PreviewAPVResults:
      paths:
      - PreviewApvArtifacts~/**
      - APVTest/**/manifest.json
    pvp-results:
      paths:
      - upm-ci~/pvp/**/*
      browsable: onDemand
  dependencies:
  - path: .yamato/wrench/package-pack-jobs.yml#package_pack_-_webrtc
  variables:
    UPMPVP_CONTEXT_WRENCH: 1.1.0.0
  metadata:
    Job Maintainers: '#rm-packageworks'
    Wrench: 1.1.0.0

# Functional tests for dependents found in the latest 6000.3 manifest (Windows).
preview_apv_-_6000_3_-_windows:
  name: Preview APV - 6000.3 - windows
  agent:
    image: package-ci/win10:default
    type: Unity::VM
    flavor: b1.large
  commands:
  - command: gsudo reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem" /v LongPathsEnabled /t REG_DWORD /d 1 /f
  - command: curl https://artifactory.prd.it.unity3d.com/artifactory/stevedore-unity-internal/wrench-localapv/1-2-68_53c92d3b34ce3f4b652c9785dd1530bdc5885f6523465d6969c3be91f9ccaaf1.zip -o wrench-localapv.zip
  - command: 7z x -aoa wrench-localapv.zip
  - command: pip install semver requests --index-url https://artifactory-slo.bf.unity3d.com/artifactory/api/pypi/pypi/simple
  - command: python PythonScripts/print_machine_info.py
  - command: npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
    timeout: 20
    retries: 10
  - command: unity-downloader-cli -u 6000.3/staging -c editor --path .Editor --fast
    timeout: 10
    retries: 3
  - command: python PythonScripts/preview_apv.py --wrench-config=.yamato/wrench/wrench_config.json --editor-version=6000.3 --testsuite=editor,playmode --artifacts-path=PreviewApvArtifacts~
  - command: python PythonScripts/editor_manifest_validator.py --version=6000.3 --wrench-config=.yamato/wrench/wrench_config.json
  after:
  - command: .yamato\generated-scripts\infrastructure-instability-detection-win.cmd
  artifacts:
    Crash Dumps:
      paths:
      - CrashDumps/**
    logs:
      paths:
      - '*.log'
      - '*.xml'
      - upm-ci~/test-results/**/*
      - upm-ci~/temp/*/Logs/**
      - upm-ci~/temp/*/Library/*.log
      - upm-ci~/temp/*/*.log
      - upm-ci~/temp/Builds/*.log
    packages:
      paths:
      - upm-ci~/packages/**/*
    PreviewAPVResults:
      paths:
      - PreviewApvArtifacts~/**
      - APVTest/**/manifest.json
    pvp-results:
      paths:
      - upm-ci~/pvp/**/*
      browsable: onDemand
  dependencies:
  - path: .yamato/wrench/package-pack-jobs.yml#package_pack_-_webrtc
  variables:
    UPMPVP_CONTEXT_WRENCH: 1.1.0.0
  metadata:
    Job Maintainers: '#rm-packageworks'
    Wrench: 1.1.0.0

# Functional tests for dependents found in the latest 6000.4 manifest (MacOS).
preview_apv_-_6000_4_-_macos:
  name: Preview APV - 6000.4 - macos
  agent:
    image: package-ci/macos-13:default
    type: Unity::VM::osx
    flavor: b1.xlarge
  commands:
  - command: curl https://artifactory.prd.it.unity3d.com/artifactory/stevedore-unity-internal/wrench-localapv/1-2-68_53c92d3b34ce3f4b652c9785dd1530bdc5885f6523465d6969c3be91f9ccaaf1.zip -o wrench-localapv.zip
  - command: 7z x -aoa wrench-localapv.zip
  - command: pip install semver requests --index-url https://artifactory-slo.bf.unity3d.com/artifactory/api/pypi/pypi/simple
  - command: python PythonScripts/print_machine_info.py
  - command: npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
    timeout: 20
    retries: 10
  - command: unity-downloader-cli -u trunk -c editor --path .Editor --fast
    timeout: 10
    retries: 3
  - command: python PythonScripts/preview_apv.py --wrench-config=.yamato/wrench/wrench_config.json --editor-version=6000.4 --testsuite=editor,playmode --artifacts-path=PreviewApvArtifacts~
  - command: echo 'Skipping Editor Manifest Validator as it is only supported on Windows'
  after:
  - command: bash .yamato/generated-scripts/infrastructure-instability-detection-mac.sh
  artifacts:
    Crash Dumps:
      paths:
      - CrashDumps/**
    logs:
      paths:
      - '*.log'
      - '*.xml'
      - upm-ci~/test-results/**/*
      - upm-ci~/temp/*/Logs/**
      - upm-ci~/temp/*/Library/*.log
      - upm-ci~/temp/*/*.log
      - upm-ci~/temp/Builds/*.log
    packages:
      paths:
      - upm-ci~/packages/**/*
    PreviewAPVResults:
      paths:
      - PreviewApvArtifacts~/**
      - APVTest/**/manifest.json
    pvp-results:
      paths:
      - upm-ci~/pvp/**/*
      browsable: onDemand
  dependencies:
  - path: .yamato/wrench/package-pack-jobs.yml#package_pack_-_webrtc
  variables:
    UPMPVP_CONTEXT_WRENCH: 1.1.0.0
  metadata:
    Job Maintainers: '#rm-packageworks'
    Wrench: 1.1.0.0

# Functional tests for dependents found in the latest 6000.4 manifest (Ubuntu).
preview_apv_-_6000_4_-_ubuntu:
  name: Preview APV - 6000.4 - ubuntu
  agent:
    image: package-ci/ubuntu-22.04:v4
    type: Unity::VM
    flavor: b1.large
  commands:
  - command: curl https://artifactory.prd.it.unity3d.com/artifactory/stevedore-unity-internal/wrench-localapv/1-2-68_53c92d3b34ce3f4b652c9785dd1530bdc5885f6523465d6969c3be91f9ccaaf1.zip -o wrench-localapv.zip
  - command: 7z x -aoa wrench-localapv.zip
  - command: pip install semver requests --index-url https://artifactory-slo.bf.unity3d.com/artifactory/api/pypi/pypi/simple
  - command: python PythonScripts/print_machine_info.py
  - command: npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
    timeout: 20
    retries: 10
  - command: unity-downloader-cli -u trunk -c editor --path .Editor --fast
    timeout: 10
    retries: 3
  - command: python PythonScripts/preview_apv.py --wrench-config=.yamato/wrench/wrench_config.json --editor-version=6000.4 --testsuite=editor,playmode --artifacts-path=PreviewApvArtifacts~
  - command: echo 'Skipping Editor Manifest Validator as it is only supported on Windows'
  after:
  - command: bash .yamato/generated-scripts/infrastructure-instability-detection-linux.sh
  artifacts:
    Crash Dumps:
      paths:
      - CrashDumps/**
    logs:
      paths:
      - '*.log'
      - '*.xml'
      - upm-ci~/test-results/**/*
      - upm-ci~/temp/*/Logs/**
      - upm-ci~/temp/*/Library/*.log
      - upm-ci~/temp/*/*.log
      - upm-ci~/temp/Builds/*.log
    packages:
      paths:
      - upm-ci~/packages/**/*
    PreviewAPVResults:
      paths:
      - PreviewApvArtifacts~/**
      - APVTest/**/manifest.json
    pvp-results:
      paths:
      - upm-ci~/pvp/**/*
      browsable: onDemand
  dependencies:
  - path: .yamato/wrench/package-pack-jobs.yml#package_pack_-_webrtc
  variables:
    UPMPVP_CONTEXT_WRENCH: 1.1.0.0
  metadata:
    Job Maintainers: '#rm-packageworks'
    Wrench: 1.1.0.0

# Functional tests for dependents found in the latest 6000.4 manifest (Windows).
preview_apv_-_6000_4_-_windows:
  name: Preview APV - 6000.4 - windows
  agent:
    image: package-ci/win10:default
    type: Unity::VM
    flavor: b1.large
  commands:
  - command: gsudo reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem" /v LongPathsEnabled /t REG_DWORD /d 1 /f
  - command: curl https://artifactory.prd.it.unity3d.com/artifactory/stevedore-unity-internal/wrench-localapv/1-2-68_53c92d3b34ce3f4b652c9785dd1530bdc5885f6523465d6969c3be91f9ccaaf1.zip -o wrench-localapv.zip
  - command: 7z x -aoa wrench-localapv.zip
  - command: pip install semver requests --index-url https://artifactory-slo.bf.unity3d.com/artifactory/api/pypi/pypi/simple
  - command: python PythonScripts/print_machine_info.py
  - command: npm install upm-ci-utils@stable -g --registry https://artifactory.prd.cds.internal.unity3d.com/artifactory/api/npm/upm-npm
    timeout: 20
    retries: 10
  - command: unity-downloader-cli -u trunk -c editor --path .Editor --fast
    timeout: 10
    retries: 3
  - command: python PythonScripts/preview_apv.py --wrench-config=.yamato/wrench/wrench_config.json --editor-version=6000.4 --testsuite=editor,playmode --artifacts-path=PreviewApvArtifacts~
  - command: python PythonScripts/editor_manifest_validator.py --version=6000.4 --wrench-config=.yamato/wrench/wrench_config.json
  after:
  - command: .yamato\generated-scripts\infrastructure-instability-detection-win.cmd
  artifacts:
    Crash Dumps:
      paths:
      - CrashDumps/**
    logs:
      paths:
      - '*.log'
      - '*.xml'
      - upm-ci~/test-results/**/*
      - upm-ci~/temp/*/Logs/**
      - upm-ci~/temp/*/Library/*.log
      - upm-ci~/temp/*/*.log
      - upm-ci~/temp/Builds/*.log
    packages:
      paths:
      - upm-ci~/packages/**/*
    PreviewAPVResults:
      paths:
      - PreviewApvArtifacts~/**
      - APVTest/**/manifest.json
    pvp-results:
      paths:
      - upm-ci~/pvp/**/*
      browsable: onDemand
  dependencies:
  - path: .yamato/wrench/package-pack-jobs.yml#package_pack_-_webrtc
  variables:
    UPMPVP_CONTEXT_WRENCH: 1.1.0.0
  metadata:
    Job Maintainers: '#rm-packageworks'
    Wrench: 1.1.0.0

